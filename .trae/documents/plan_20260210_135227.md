# Bilibili 自动评论失败修复计划

**问题诊断**：
日志显示 `Could not find comment box: Timeout 3000ms exceeded`。这是因为 Bilibili 评论区是**懒加载**（Lazy Load）的，必须滚动到可视区域才会渲染 DOM。当前的“固定距离滚动”（2000px）在长视频页面或高分辨率下可能不够，导致 Playwright 未能触发加载，从而找不到评论框。

**解决方案**：
实施**智能动态滚动策略**，不再依赖固定距离，而是主动寻找评论区锚点并循环检测。

## 🛠️ 执行步骤

### 1. 抽取选择器配置 (`core/selectors.py`)
为了提高代码的可维护性，避免硬编码，我将新建一个 `selectors.py` 文件，集中管理所有 CSS 选择器（包括评论框、容器、发送按钮、登录元素等）。
*   *新增* `COMMENT_CONTAINER`: `#comment, .comment-container` (评论区外层容器)
*   *迁移* 现有的 `COMMENT_INPUT` 和 `SEND_BTN` 选择器。

### 2. 重构滚动逻辑 (`core/comment.py`)
修改 `post_comment` 方法，替换原有的固定滚动逻辑：
*   **锚点定位**：优先尝试寻找并滚动到评论区容器 `#comment`。
*   **循环探测**：如果未找到输入框，则执行“滚动-等待-检测”循环（最多尝试 5-10 次，每次滚动 500px），确保触发懒加载。
*   **超时优化**：将 `wait_for_selector` 的超时时间从 3000ms 适当延长至 5000ms（配合循环机制）。

### 3. 验证修复
修改完成后，您只需重新运行 `python gui.py` 即可测试修复效果。

准备就绪，确认后我将开始创建 `core/selectors.py` 并修改 `core/comment.py`。