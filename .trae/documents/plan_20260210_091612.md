# 修复登录与评论定位问题

针对您反馈的两个问题，我将执行以下优化方案：

## 1. 优化登录逻辑 (`core/auth.py`)
**问题分析**：当前逻辑仅检测 URL 变化来判断登录成功，导致用户扫码成功后（页面通常停留在原处或跳转不明显）程序仍在死循环等待，直到手动关闭窗口。
**解决方案**：
*   在扫码等待循环中，**主动轮询**登录状态（通过检查 Cookie 或页面特定元素）。
*   一旦检测到登录成功（`_check_login_status()` 返回 True），立即跳出循环，无需等待用户关闭窗口。

## 2. 修复评论框定位 (`core/comment.py`)
**问题分析**：B 站评论区采用懒加载（Lazy Load），且新版界面可能使用了不同的 CSS 选择器（如富文本编辑框 `div[contenteditable="true"]` 而非传统 `textarea`）。
**解决方案**：
*   **增强滚动逻辑**：评论区通常位于页面下方，需要大幅度滚动（例如 2000px）并等待加载，确保 DOM 元素被渲染。
*   **更新选择器**：
    *   增加对新版富文本输入框的支持：`div.bili-rich-text-input, div[contenteditable="true"]`。
    *   保留旧版兼容：`.reply-box-textarea`。
*   **增加重试机制**：如果首次定位失败，尝试寻找页面上的“评论”字样锚点再次定位。

我将立即修改 `core/auth.py` 和 `core/comment.py` 来实施修复。