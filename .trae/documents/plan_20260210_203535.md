I will adopt the "Crawl then Comment" strategy (Producer-Consumer pattern simplified) to ensure we have enough videos before starting comments.

**Revised Plan:**

1.  **Refactor `main.py` Logic**:
    *   **Phase 1: Video Gathering (The "Candidate Pool")**
        *   Create a `candidate_videos` list.
        *   Loop through keywords. For each keyword:
            *   Call `search_videos`.
            *   **Crucial Change**: Pass a larger `max_count` to `search_videos` (e.g., `target_count * 2` or `target_count + 10`) to ensure we get enough *potential* videos.
            *   Filter these videos against `HistoryManager` immediately.
            *   Filter against "Strict Title Match" (if enabled).
            *   Add *valid, new* videos to `candidate_videos`.
            *   **Stop gathering** for this keyword if we have enough videos to satisfy the global or keyword-specific target.
            *   *Feedback Loop*: If we don't have enough after one search, we might need to search more (but `search.py` currently only does one page/scroll). For now, increasing the initial fetch count is the most effective way without rewriting `search.py` to support pagination. I will set the fetch limit high enough.

    *   **Phase 2: Comment Execution**
        *   Iterate through `candidate_videos`.
        *   Stop when `successful_comments` reaches `max_videos_per_keyword` (or the global limit, depending on interpretation - usually it's per keyword in this config, but the user said "Run Parameter Max Comment Count", which implies a global session limit).
        *   *Clarification*: The config has `max_videos_per_keyword`. The GUI has "Max Comments". I will assume the GUI setting overrides/sets the `max_videos_per_keyword` *or* acts as a total limit.
        *   *Implementation*: I will treat the GUI "Max Comments" as the **Total Target** for the session.
        *   Execute comments.
        *   Update GUI list status.

2.  **Specific Changes**:
    *   **`main.py`**:
        *   Initialize `total_success = 0`.
        *   Inside keyword loop:
            *   Calculate `needed = target_count - total_success`.
            *   Fetch videos with `limit = needed * 3` (buffer).
            *   Filter videos (History + Strict Match).
            *   Process comments.
            *   If `total_success >= target_count`, break all loops.

3.  **Config & GUI**:
    *   Ensure the "Max Comments" value is correctly used as the session target.

This approach "Gather enough, then comment" (or "Gather, Filter, Comment loop") directly addresses the user's request to ensure the *actual* number of comments matches the target by accounting for skipped videos *before* giving up.

**Why this fixes the issue**:
The previous code fetched exactly `target_count` videos. If 1 was skipped, it processed only `target_count - 1`.
The new code will fetch `target_count * 3` videos. If 1 is skipped, we still have plenty left to reach `target_count`.

**Files to Modify**:
*   `main.py`

**Note on "Sync Execution"**:
The user mentioned "or sync execution". The `main.py` loop is already synchronous (Search -> Filter -> Comment). The key missing piece was dynamic refilling or over-fetching. I will implement **Over-fetching** as it's simpler and robust.